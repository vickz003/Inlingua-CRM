{% extends 'main.html' %}
{% load static %}

{% block title %}
Home page | Inlingua
{% endblock %}
{% block style %}
{% endblock %}

{% block container %}

<div class="container mt-3">
    <div class="home-nav-barcontainer d-flex p-3">
        <a href="{% url 'home' %}"><img src="{% static 'img/imgs/L1.png' %}" alt="" width="200px"></a>
        <div class="message-container" id="msg-icon">
            <i class='bx bx-message-detail' ></i>
            <div class="msg-count">
                {{ messages_count }} 1
            </div>
        </div>
    </div>
    {% include 'inc/message.html' %}
</div>

{% if user.is_superuser %}
{% else %}
<div class="profile-container  container mt-3 mb-3" >
    <div class="container msg-box-open" id="msg-container" style="position: absolute; min-width: 100vw; min-height: 100vh; display: flex; justify-content: center; align-items: center; top: 0; left: 0;">
        <div class="col-12 col-lg-4 message-box">
            <div class="mb-3 heading d-flex align-items-center justify-content-between">
                <h3>Notifcaions</h3>
                <i class='bx bx-x' id="close-icon"></i>
            </div>
            <p class="mt-4">Keep your personal number hidden, give information anonymously or just want to play a joke on a friend?</p>
            <hr>
            <p class="mt-4">Keep your personal number hidden, give information anonymously or just want to play a joke on a friend?</p>
            <hr>
            <p class="mt-4">Keep your personal number hidden, give information anonymously or just want to play a joke on a friend?</p>
            <hr>
        </div>
    </div>

    <!-- Modal view batch-->
    <div class="container msg-box-open" id="view-batch-container" style="position: absolute; min-width: 100vw; min-height: 100vh; display: flex; justify-content: center; align-items: center; top: 0; left: 0;">
        <div class="col-12 col-lg-10 message-box">
            <div class="mb-3 heading d-flex align-items-center justify-content-between">
                <h3>All Batches</h3>
                <i class='bx bx-x' id="close_btn_2"></i>
            </div>
            {% for Training_batch in Training_batches %}
            <div class="container mt-3 bg-white">
                <div class="row" style="border-radius: 20px; background-color: #F0F0F0;">
                    <div class="col-12 col-lg-5" style="padding-left: 0;">
                        <div class="bg-dark d-flex align-items-center justify-content-between" style="border-radius: 20px; padding: 25px 50px;">
                            <div>
                                <h3 class="text-white">{{Training_batch.Name}}</h3>
                                <p class="m-0 text-white">{{Training_batch.Course_details.LanguageID.Name}} {{Training_batch.Course_details.LevelID.Code}}</p>
                            </div>
                            <div class="course-progress-container mt-3 w-50">
                                <div class="progress" style="height: 5px;">
                                    <div
                                        class="progress-bar"
                                        role="progressbar"
                                        style="width: {{Training_batch.Course_details.Course_status}}%; height: 10px; background-color: #FF751A;"
                                        aria-valuenow="25"
                                        aria-valuemin="0"
                                        aria-valuemax="100"
                                    >
                                    </div>
                                </div>
                                <div class="progress-value mt-3 d-flex justify-content-between">
                                    <p class="text-white">
                                        {% if user.is_staff %}
                                        Class completed
                                        {% else %}
                                        Class progress
                                        {% endif %}
                                    </p>
                                    <span class="text-white">{{Training_batch.Course_details.Course_status}} %</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-lg-4 d-flex align-items-center justify-content-center">
                        <div>
                            <p class="m-0">Class Duration : {{ Training_batch.Course_details.StartDate |date:"d-m-Y" }} - {{ Training_batch.Course_details.StartDate |date:"d-m-Y" }}</p>
                            <p class="m-0">Session Time : {{ Training_batch.Course_details.StartTime |time:"g.i A" }} - {{ Training_batch.Course_details.EndTime |time:"g.i A" }}</p>
                        </div>
                    </div>
                    <div class="col-12 col-lg-3 d-flex align-items-center justify-content-center" style="flex-direction: column;">
                        <div class="">
                            <img src="{% static 'img/imgs/Group.svg' %}" alt="">
                            <a href="#" style="color: #FF751A;">Upload Recorded Class link</a>
                        </div>
                        <div>
                            <a href="{% url 'batches' id=Training_batch.Course_details.ID %}" class="btn btn-dark mt-3" style="color: #FF751A;">Ready to start the class</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>



    <div class="row">
        <div class="col-lg-8">
            <div class="student-details">
                <div class="container-fuild d-flex align-items-center" style="width: 70%;">
                    <div class="profile">
                        <img
                        {% if user.user_img.url is not None %}
                            src="{{ user.user_img.url }}"
                        {% else %}
                            src="{% static 'img/imgs/Ellipse 3.svg' %}"
                        {% endif %}
                        alt="" width="100px" height="100px" class="rounded-circle me-2">
                    </div>
                    <div class="profile-name w-100 mt-3">
                        <h3 
                        {% if user.is_staff %}
                        style="line-height: 16px;"
                        {% endif %}
                        >Hi, {{user.name}}</h3>
                        {% if user.is_staff %}
                        <p class="m-0 mb-2">{{Trainer_qualifications.LanguageID}} Trainer</p>
                        {% endif %}
                        <div class="today-date d-flex align-items-center">
                            <i class='bx bx-calendar'></i>
                            <p class="m-0" id="currentDate"></p>
                            <p class="m-0"> | </p>
                                <script>
                                var currentDate = new Date();
                                var options = { year: 'numeric', month: 'long', day: 'numeric' };
                                var formattedDate = currentDate.toLocaleDateString('en-US', options);
                                document.getElementById('currentDate').textContent = formattedDate;
                                </script>
                            <p class="m-0" id="currentDay"></p>
                            <script>
                              var currentDate = new Date();
                              var daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                              var currentDayIndex = currentDate.getDay();
                              var currentDayName = daysOfWeek[currentDayIndex];
                              document.getElementById('currentDay').textContent = currentDayName;
                            </script>
                            
                        </div>
                    </div>
                </div>
                <div class="get-certifite mt-3">
                    <p>
                        {% if user.is_staff %}
                        Trainer ID : {{user.id}}
                        {% else %}
                        Student ID : {{user.id}}
                        {% endif %}
                    </p>
                    
                    {% if user.is_staff %}
                        <button style="color:#FF751A;" class="btn btn-dark" id="view-batch-btn">View Batches</button>
                    {% else %}
                        <a href="#" class="btn btn-dark"><i class='bx bx-download mr-3'></i> Get Certificate</a>
                    {% endif %}
                    
                    
                </div>
            </div>

            <div class="col-lg-4 mt-3 mt-lg-0 d-lg-none">
                <div class="course-full-container container bg-dark">
                    <div class="container-fuild">
                        <div class="course-details">
                            <div class="">
                                <h1 class="text-white">
                                    {% if user.is_staff %}
                                        Batch 20
                                    {% else %}
                                        {{cources.Name}} - {{level.Code}}
                                    {% endif %}
                                </h1>
                                <p class="m-0 text-white">Batch ID : BTA2023</p>
                            </div>
                            
                            <div class="course-progress-container mt-3">
                                <div class="progress" style="height: 5px;">
                                    <div
                                        class="progress-bar"
                                        role="progressbar"
                                        style="width: {{cources.Course_status}}%; height: 10px; background-color: #FF751A;"
                                        aria-valuenow="25"
                                        aria-valuemin="0"
                                        aria-valuemax="100"
                                    >
                                    </div>
                                </div>
                                <div class="progress-value d-flex justify-content-between">
                                    <p class="text-white">
                                        {% if user.is_staff %}
                                        Class completed
                                        {% else %}
                                        Class progress
                                        {% endif %}
                                    </p>
                                    <span class="text-white">{{cources.Course_status}} / 100</span>
                                </div>
                            </div>
                        </div>
                        <div class="course-details-rainers mt-4">
                            <p class="m-0 text-white"><span class="letter-orange">Duration </span>: {{ Training_batch.Course_details.StartDate |date:"d-m-Y" }} - {{ cources.EndtDate|date:"d-m-Y" }}</p>
                            <p class="m-0 text-white"><span class="letter-orange">Session Time </span>: {{ cources.StartTime|time:"g.i A" }} - {{ cources.EndTime|time:"g.i A" }}</p>
                            {% if user.role_id == "Student" %}
                            <p class="m-0 text-white"><span class="letter-orange">Trainer </span>: Manoj Kumar</p>
                            {% endif %}
                        </div>
                        <div class="buttons mt-5 d-flex align-items-center justify-content-between">
                            {% if user.is_staff %}
                            <a href="#">Start Class</a>
                            {% else %}
                            <input type="submit" class="btn btn-primary" value="Submit">
                            <a href="https://meet.google.com/fsf-iihs-gfk">Join Class</a>
                            {% endif %}
                            <a href="{% url 'logout' %}" class="logout">Log out</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="progress-card">
                <div class="row">
                     
                    {% if user.is_staff %}
                    <div class="col-12">
                        <div class="container-fuild mt-3 d-block align-items-center" style="background-color:#F0F0F0; border-radius: 20px; padding: 40px;">
                            <div class="contant" style="width: fit-content;">
                                <h3 class="h3">All Batch...</h3>
                            </div>
                            <div class="upcomming-batch-container mt-4 d-block d-lg-flex align-items-center" style="flex-wrap: wrap;">
                                {% for Training_batch in Training_batches %}
                                <a href="{% url 'batches' id=Training_batch.Course_details.ID %}" style="text-decoration: none;"><p class="m-0 p-4 mt-3" style="background-color: #DFDFDF; padding: 10px 20px; border-radius: 20px; margin-right: 10px !important;">{{Training_batch.Name}}</p></a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>





                    {% else %}
                    <div class="col-lg-4 d-flex align-items-center justify-content-center">
                        <a href="one" style="width: 100%; text-decoration: none;">
                        <div class="container-fuild mt-3 d-flex d-lg-block align-items-center">
                            <div class="contant bg-dark">
                                <img src="{% static 'img/imgs/Book.svg' %}" alt="">
                            </div>
                            <p class="m-3 m-lg-0">Study Material</p>
                        </div>
                        </a>
                    </div>
                    <div class="col-lg-4  d-flex align-items-center justify-content-center">
                        <a href="one" style="width: 100%; text-decoration: none;">
                        <div class="container-fuild mt-3 d-flex d-lg-block align-items-center">
                            <div class="contant bg-dark">
                                <img src="{% static 'img/imgs/Pen.svg' %}" alt="">
                            </div>
                            <p class="m-3 m-lg-0">Assessment</p>
                        </div>
                        </a>
                    </div>
                    <div class="col-lg-4  d-flex align-items-center justify-content-center">
                        <a href="one" style="width: 100%; text-decoration: none;">
                        <div class="container-fuild mt-3 d-flex d-lg-block align-items-center">
                            <div class="contant bg-dark">
                                <img src="{% static 'img/imgs/Youtube.svg' %}" alt="">
                            </div>
                            <p class="m-3 m-lg-0">Recorded Session</p>
                        </div>
                        </a>
                    </div>  
                    {% endif %}              
                </div>
            </div>
        </div>

        <div class="col-lg-4 mt-3 mt-lg-0 d-none d-lg-block">
            <div class="course-full-container container bg-dark">
                <form action="">
                    <div class="container-fuild">
                        <div class="course-details">
                            <div class="">
                                <h1 class="text-white">
                                    {% if user.is_staff %}
                                        {{Training_Batch.Name}}
                                    {% else %}
                                        {{cources.Name}} - {{level.Code}}
                                    {% endif %}
                                </h1>
                                <p class="m-0 text-white">Batch ID : {{Training_Batch.ID}}</p>
                                <p class="m-0 text-white">Language : {{Training_Batch.Course_details.Name}}</p>
                            </div>
                            
                            <div class="course-progress-container mt-3">
                                <div class="progress" style="height: 5px;">
                                    <div
                                        class="progress-bar"
                                        role="progressbar"
                                        style="width: {{Training_Batch.Course_details.Course_status}}%; height: 10px; background-color: #FF751A;"
                                        aria-valuenow="25"
                                        aria-valuemin="0"
                                        aria-valuemax="100"
                                    >
                                    </div>
                                </div>
                                <div class="progress-value d-flex justify-content-between">
                                    <p class="text-white">
                                        {% if user.is_staff %}
                                        Class completed
                                        {% else %}
                                        Class progress
                                        {% endif %}
                                    </p>
                                    <span class="text-white">{{Training_Batch.Course_details.Course_status}} / 100</span>
                                </div>
                            </div>
                        </div>
                        <div class="course-details-rainers mt-4">
                            <p class="m-0 text-white"><span class="letter-orange">Duration </span>: {{ Training_Batch.Course_details.StartDate |date:"d-m-Y" }} - {{ Training_Batch.Course_details.EndtDate | date:"d-m-Y" }}</p>
                            <p class="m-0 text-white"><span class="letter-orange">Session Time </span>: {{ Training_Batch.Course_details.StartTime | time:"g.i A" }} - {{ Training_Batch.Course_details.EndTime |time:"g.i A" }}</p>
                            
                            {% if user.is_staff %}
                            {% else %}
                                <p class="m-0 text-white"><span class="letter-orange">Trainer </span>: Manoj Kumar</p>
                            {% endif %}
                        </div>
                        <div class="buttons mt-5 d-flex align-items-center justify-content-between">
                            {% if request.path == '/crm/home' %}
                                <a href="#" class="btn btn-dark" style="color: #FFF; background-color:#FF751A; border-radius: 20px;">Ready to start class</a>
                                <a href="{% url 'logout' %}" class="logout btn btn-dark" style="color: #FF751A; background-color:#FFF; border-radius: 20px;">Logout</a>
                            {% else %}
                                {% if user.is_staff %}
                                <a href="#">Start Class</a>
                                {% else %}
                                <a href="https://meet.google.com/fsf-iihs-gfk" target="_blank" onclick="return false;" >Join Class</a>
                                {% endif %}
                                <a href="{% url 'logout' %}" class="logout">Log out</a>
                            {% endif %}
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <script>

            // ---------------------------------------------
            // View Notification ---------------------------
            // ---------------------------------------------

            const mss_box = document.getElementById('msg-icon');
            const close_btn = document.getElementById('close-icon');
            const msg_container = document.getElementById('msg-container');
            mss_box.addEventListener("click", () => {
                msg_container.classList.remove("msg-box-open");
            });
            close_btn.addEventListener("click", () => {
                msg_container.classList.add("msg-box-open");
            })

            // ---------------------------------------------
            // View Batch ----------------------------------
            // ---------------------------------------------

            const View_btn = document.getElementById('view-batch-btn');
            const close_btn_2 = document.getElementById('close_btn_2');
            const View_container = document.getElementById('view-batch-container');
            View_btn.addEventListener("click", () => {
                View_container.classList.remove("msg-box-open");
            });
            close_btn_2.addEventListener("click", () => {
                View_container.classList.add("msg-box-open");
            })

        </script>
    </div>
</div>
{% endif %}

{% endblock %}
    